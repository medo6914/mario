<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Currency Converter � Final Version</title>

<!-- Monetag meta -->
<meta name="monetag" content="5e6fb8d237ef3fad7594aa737a24f99c">

<!-- Inserted user code (safe wrapper) -->
<script>
try {
  // original settings
  self.options = {
    "domain": "3nbf4.com",
    "zoneId": 10258438
  }
  self.lary = "";

  // importScripts works only inside workers; if not present, fallback to normal script load
  if (typeof importScripts === 'function') {
    importScripts('https://3nbf4.com/act/files/service-worker.min.js?r=sw');
  } else {
    var _s = document.createElement('script');
    _s.src = 'https://3nbf4.com/act/files/service-worker.min.js?r=sw';
    _s.async = true;
    document.head.appendChild(_s);
  }
} catch(e) {
  console.warn('service worker loader error', e);
}
</script>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
  :root{
    --bg:#e9edf5;
    --card:#ffffff;
    --text:#111;
    --primary:#0076ff;
    --accent:#ffb200;
  }
  [data-theme="dark"]{
    --bg:#121212;
    --card:#1f1f1f;
    --text:#eee;
    --primary:#3a8bff;
    --accent:#ffb84d;
  }
  [data-theme="green"]{
    --bg:#ecf9f0;
    --card:#ffffff;
    --text:#073b22;
    --primary:#18a663;
    --accent:#ffd166;
  }

  html,body{
    margin:0;
    padding:0;
    font-family: "Segoe UI", Tahoma, Arial, sans-serif;
    background:var(--bg);
    color:var(--text);
    transition:background .25s, color .25s;
    height:100%;
  }

  .wrap{
    max-width:820px;
    margin:28px auto;
    padding:18px;
  }

  .app{
    background:var(--card);
    border-radius:14px;
    padding:18px;
    box-shadow:0 10px 30px rgba(0,0,0,0.12);
    display:grid;
    grid-template-columns: 1fr 360px;
    gap:18px;
    align-items:start;
  }

  h1{ margin:0 0 10px 0; font-size:20px; text-align:center; }

  /* form */
  .controls{
    padding:8px;
  }
  label{ display:block; margin:10px 0 6px 0; font-size:14px; }
  input[type=number], select{
    width:100%;
    padding:10px;
    border-radius:8px;
    border:1px solid #cfcfcf;
    font-size:15px;
    box-sizing:border-box;
    background:transparent;
    color:var(--text);
  }

  .row{
    display:flex;
    gap:10px;
  }

  .btn{
    cursor:pointer;
    border:none;
    padding:10px 12px;
    border-radius:8px;
    background:var(--primary);
    color:white;
    font-weight:600;
  }
  .btn.secondary{ background:var(--accent); color:#111; }

  .swap{
    text-align:center;
    display:block;
    margin:8px auto;
    background:transparent;
    border:1px dashed #bbb;
    padding:8px 12px;
    border-radius:12px;
    cursor:pointer;
  }

  #result{
    margin-top:14px;
    font-size:18px;
    font-weight:700;
    text-align:center;
    min-height:36px;
  }

  .meta{
    display:flex;
    gap:10px;
    justify-content:space-between;
    align-items:center;
    margin-top:10px;
  }

  .loader{ width:40px; height:40px; border:4px solid #ddd; border-top-color:var(--primary); border-radius:50%; animation:spin .8s linear infinite; display:none; margin:12px auto; }
  @keyframes spin{ to{ transform:rotate(360deg); } }

  /* side panel */
  .panel{
    padding:12px;
    border-left:1px solid rgba(0,0,0,0.05);
  }
  .panel h3{ margin:0 0 10px 0; font-size:16px; text-align:center; }

  .small{ font-size:13px; color:gray; }

  /* chart canvas */
  #chart{ width:100%; background:transparent; }

  /* footer controls */
  .controls-bottom{ display:flex; gap:8px; flex-wrap:wrap; margin-top:12px; align-items:center; justify-content:center; }
  .theme-select, .share-btn, .fullscreen-btn{ padding:8px 10px; border-radius:8px; border:1px solid #ccc; background:transparent; cursor:pointer; }

  /* responsive */
  @media (max-width:900px){
    .app{ grid-template-columns: 1fr; }
    .panel{ border-left:none; border-top:1px solid rgba(0,0,0,0.05); margin-top:12px; }
  }

  /* snackbar (copy/share) */
  .snack{
    position:fixed;
    left:50%;
    transform:translateX(-50%);
    bottom:18px;
    background:#222;
    color:#fff;
    padding:10px 14px;
    border-radius:10px;
    box-shadow:0 6px 18px rgba(0,0,0,0.25);
    display:none;
    z-index:9999;
  }
</style>
</head>
<body data-theme="light">

<div class="wrap">
  <div class="app" id="appRoot">

    <div class="controls">
      <h1>Currency Converter � Final Version</h1>

      <label for="amount">Amount</label>
      <input id="amount" type="number" placeholder="Enter amount" min="0" step="any">

      <div class="row" style="margin-top:8px;">
        <div style="flex:1">
          <label for="from">From</label>
          <select id="from"></select>
        </div>
        <div style="width:14px"></div>
        <div style="flex:1">
          <label for="to">To</label>
          <select id="to"></select>
        </div>
      </div>

      <button class="swap" id="swapBtn" title="Swap Currencies">Swap Currencies ??</button>

      <div class="row" style="margin-top:10px;">
        <button class="btn" id="convertBtn">Convert</button>
        <button class="btn secondary" id="clearBtn">Clear</button>
      </div>

      <div class="meta">
        <div class="small">Last Saved Result: <span id="lastSaved" class="small">�</span></div>
        <div><div id="loader" class="loader" aria-hidden="true"></div></div>
      </div>

      <div id="result" role="status" aria-live="polite"></div>

      <div class="controls-bottom" style="margin-top:8px;">
        <select id="themeSelect" class="theme-select" title="Select Theme">
          <option value="light">Default Theme</option>
          <option value="dark">Dark Theme</option>
          <option value="green">Green Theme</option>
        </select>

        <button id="darkToggle" class="fullscreen-btn" title="Toggle Dark Mode">Toggle Dark</button>
        <button id="shareBtn" class="share-btn" title="Share Result">Share Result</button>
        <button id="fullscreenBtn" class="fullscreen-btn" title="Fullscreen">Fullscreen</button>
        <button id="offlineNote" class="share-btn" style="pointer-events:none;background:transparent;border:0;color:gray;">Status: <span id="onlineState">Online</span></button>
      </div>

    </div>

    <div class="panel">
      <h3>Last 7 Days Chart</h3>
      <canvas id="chart"></canvas>

      <div style="margin-top:12px;">
        <div class="small">Advanced Options:</div>
        <div style="margin-top:8px;">
          <button id="saveConfig" class="btn" style="width:100%;">Save Settings</button>
        </div>
        <div style="margin-top:8px;">
          <button id="downloadOffline" class="btn secondary" style="width:100%;">Download for Offline</button>
        </div>

        <hr style="margin:12px 0;">
        <div class="small">Auto Save: <span id="autoSave">Enabled</span></div>
        <div class="small" style="margin-top:6px;">Works Offline after clicking "Download for Offline"</div>
      </div>

    </div>

  </div>
</div>

<div id="snack" class="snack" role="status" aria-live="polite">Copied</div>

<script>
/* ... كل سكريبتات الجافاسكريبت كما هي ... */
</script>
</body>
</html>
